
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../About/">
      
      
        <link rel="next" href="../Critical_notes/">
      
      
      <link rel="icon" href="../../../../../assets/Universal_hal_logo_top_bar.svg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>Usage - Universal_hal</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#atmel-samd2151-spi-api-usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Universal_hal" class="md-header__button md-logo" aria-label="Universal_hal" data-md-component="logo">
      
  <img src="../../../../../assets/Universal_hal_logo_top_bar.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Universal_hal
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Universal_hal" class="md-nav__button md-logo" aria-label="Universal_hal" data-md-component="logo">
      
  <img src="../../../../../assets/Universal_hal_logo_top_bar.svg" alt="logo">

    </a>
    Universal_hal
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GPIO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            GPIO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../GPIO/gpio_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../GPIO/gpio_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3_1" id="__nav_2_1_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../GPIO/platform/atmelsam/about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    I2C Host
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            I2C Host
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_host/i2c_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_host/i2c_host_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3_1" id="__nav_2_2_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_host/platform/atmelsam/about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_host/platform/atmelsam/Usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_host/platform/atmelsam/Critical_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Critical Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3_1_4" id="__nav_2_2_3_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Doxygen
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Doxygen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../atmelsam_i2c_host/annotated/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Struct List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../atmelsam_i2c_host/class_member_variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Struct Member Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../atmelsam_i2c_host/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../atmelsam_i2c_host/variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../atmelsam_i2c_host/macros/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Macros
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../atmelsam_i2c_host/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Files
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    I2C Slave
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            I2C Slave
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_slave/i2c_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_slave/i2c_slave_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3_1" id="__nav_2_3_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_slave/platform/atmelsam/About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_slave/platform/atmelsam/Usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../I2C_slave/platform/atmelsam/Critical_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Critical Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SPI Host
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            SPI Host
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../spi_host_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../spi_host_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4_3_1" id="__nav_2_4_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Usage
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#platform-specific-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Platform specific settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Platform specific settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clocks" class="md-nav__link">
    <span class="md-ellipsis">
      Clocks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpio-pinmux-settings" class="md-nav__link">
    <span class="md-ellipsis">
      GPIO pinmux settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spi_host_init-function" class="md-nav__link">
    <span class="md-ellipsis">
      spi_host_init function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Example configuration
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Critical_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Critical Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SPI Slave
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            SPI Slave
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../SPI_slave/spi_slave_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../SPI_slave/spi_slave_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_3" >
        
          
          <label class="md-nav__link" for="__nav_2_5_3" id="__nav_2_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_5_3_1" id="__nav_2_5_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_5_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../SPI_slave/platform/atmelsam/About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../SPI_slave/platform/atmelsam/Usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../SPI_slave/platform/atmelsam/Critical_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Critical Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UART
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            UART
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../UART/uart_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../UART/uart_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_3" >
        
          
          <label class="md-nav__link" for="__nav_2_6_3" id="__nav_2_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_6_3_1" id="__nav_2_6_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_6_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../UART/platform/atmelsam/About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../UART/platform/atmelsam/Usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../UART/platform/atmelsam/Critical_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Critical Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DMA
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            DMA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../DMA/dma_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../DMA/dma_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_3" >
        
          
          <label class="md-nav__link" for="__nav_2_7_3" id="__nav_2_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_7_3_1" id="__nav_2_7_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_7_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../DMA/platform/atmelsam/About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../DMA/platform/atmelsam/Usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../DMA/platform/atmelsam/Critical_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Critical Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    USB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            USB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../USB/usb_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../USB/usb_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_3" >
        
          
          <label class="md-nav__link" for="__nav_2_8_3" id="__nav_2_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API platform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_3">
            <span class="md-nav__icon md-icon"></span>
            API platform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_8_3_1" id="__nav_2_8_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SAMD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_8_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_3_1">
            <span class="md-nav__icon md-icon"></span>
            SAMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../USB/platform/atmelsam/About/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../USB/platform/atmelsam/Usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../USB/platform/atmelsam/Critical_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Critical Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../code_style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code style
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#platform-specific-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Platform specific settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Platform specific settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clocks" class="md-nav__link">
    <span class="md-ellipsis">
      Clocks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpio-pinmux-settings" class="md-nav__link">
    <span class="md-ellipsis">
      GPIO pinmux settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spi_host_init-function" class="md-nav__link">
    <span class="md-ellipsis">
      spi_host_init function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Example configuration
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="atmel-samd2151-spi-api-usage">Atmel SAMD21/51 SPI API usage</h1>
<p>The general API for SPI communication on Atmel SAMD21/51 microcontrollers, while consistent across various models, involves platform-specific intricacies, particularly in clock system linkage. These specifics cannot be generalized through simple abstractions.</p>
<p>Consequently, the design approach was to decouple these details via a generic API, allowing for the configuration of essential parameters while accommodating platform-specific requirements.</p>
<h2 id="platform-specific-settings">Platform specific settings</h2>
<p>To correctly utilize the SPI peripheral, certain preparatory steps are essential. The following checklist should be completed:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Set up the clocks for the SPI peripheral (this step can be skipped when using ASF or Arduino frameworks).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Configure the pins for the SPI peripheral (refer to the GPIO section on this page).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Utilize the spi_host_init function with appropriate configuration settings.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Click on the checkmarks above to track your progress.</p>
</div>
<h3 id="clocks">Clocks</h3>
<p>This implementation does not configure clock generators but merely connects the SPI peripheral to pre-existing clock generators. These generators must be set up either by your integrating code or by the software framework you are using.</p>
<p>Frameworks like Arduino and ASF, which utilize the Atmel Start tool, typically handle most of the configuration. Both these frameworks default to using clock generator 0 set at 48 MHz (Arduino) or 8 MHz (ASF) and clock generator 1 set at 32.768 KHz.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The SPI peripheral requires two clocks for proper functioning: a slow one (&lt; 100 KHz) primarily for internal timing and synchronization, and a fast one (â‰¥ twice the frequency of SCK). The fast clock is used for operational purposes in host mode.</p>
</div>
<h3 id="gpio-pinmux-settings">GPIO pinmux settings</h3>
<p>In addition to configuring the spi_host_init() function with the correct settings, the pins must be linked to the hardware peripheral using the SAMD's built-in pinmux. This is achieved with the gpio_set_pin_mode function:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">gpio_set_pin_mode</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">gpio_pin_t</span><span class="w"> </span><span class="n">pin</span><span class="p">,</span><span class="w"> </span><span class="n">gpio_mode_t</span><span class="w"> </span><span class="n">pin_mode</span><span class="p">);</span>
</code></pre></div>
<details class="question">
<summary>How to set the right pin mode?</summary>
<p>Refer to <a href="https://ww1.microchip.com/downloads/aemDocuments/documents/MCU32/ProductDocuments/DataSheets/SAM-D21-DA1-Family-Data-Sheet-DS40001882H.pdf">Table 7-1 of the SAMD21 datasheet</a> or <a href="https://ww1.microchip.com/downloads/aemDocuments/documents/MCU32/ProductDocuments/DataSheets/SAM-D5x-E5x-Family-Data-Sheet-DS60001507.pdf">Table 6-1 of the SAMD51 datasheet</a> to determine the correct <code>pin_mode</code>.</p>
<p>For instance, configuring PA4 and PA5 of the SAMD21 for the SDA and SCL output of SERCOM 0 would require setting these pins to pin mode D. The function calls would be as follows:
<div class="highlight"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="n">gpio_pin_t</span><span class="w"> </span><span class="n">SDA_PIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GPIO_PIN_PA4</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="n">gpio_pin_t</span><span class="w"> </span><span class="n">SCL_PIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GPIO_PIN_PA5</span><span class="p">;</span>

<span class="n">gpio_set_pin_mode</span><span class="p">(</span><span class="n">SDA_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_MODE_D</span><span class="p">);</span>
<span class="n">gpio_set_pin_mode</span><span class="p">(</span><span class="n">SCL_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_MODE_D</span><span class="p">);</span>
</code></pre></div></p>
</details>
<h3 id="spi_host_init-function">spi_host_init function</h3>
<p>The spi_host_init function is used to initialize the SPI hardware peripheral with the required settings. Compile-time validation of each setting is possible using the SPI_HOST_INIT() macro, which checks parameters before replacing the function call with spi_host_init.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">spi_host_init</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">spi_host_inst_t</span><span class="w"> </span><span class="n">spi_peripheral_num</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="k">const</span><span class="w"> </span><span class="n">spi_clock_sources_t</span><span class="w"> </span><span class="n">clock_sources</span><span class="p">,</span>
<span class="w">                   </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">periph_clk_freq</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">spi_bus_frequency</span><span class="p">,</span>
<span class="w">                   </span><span class="k">const</span><span class="w"> </span><span class="n">spi_bus_opt_t</span><span class="w"> </span><span class="n">extra_configuration_options</span><span class="p">);</span>
</code></pre></div>
<p>The following parameters can be set within this function:</p>
<details class="info">
<summary>spi_peripheral_num</summary>
<p>Specifies the SERCOM number to couple the module to.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be aware that these peripherals are shared with the UART, SPI, and I2C drivers. Ensure that this driver is the sole user of the selected peripheral to prevent overwriting any previous configurations. These peripherals can only be used for one communication interface type at a time.</p>
</div>
<p>Example SAMD21 microcontroller configuration values:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">SPI_PERIPHERAL_0</span><span class="p">,</span>
<span class="w">    </span><span class="n">SPI_PERIPHERAL_1</span><span class="p">,</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">SPI_PERIPHERAL_5</span>
<span class="p">}</span><span class="w"> </span><span class="n">spi_host_inst_t</span><span class="p">;</span>
</code></pre></div>
These values directly map to the SERCOM_x peripherals.</p>
<p>Example usage:</p>
<table>
<thead>
<tr>
<th>Sercom</th>
<th>spi_peripheral_num value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sercom 0</td>
<td>SPI_PERIPHERAL_0</td>
</tr>
<tr>
<td>Sercom ...</td>
<td>SPI_PERIPHERAL_...</td>
</tr>
</tbody>
</table>
</details>
<details class="info">
<summary>clock_sources</summary>
<p>Designates the clock sources for the SPI peripheral.</p>
<p>Configuration options for the SAMD21 microcontrollers:
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">SPI_CLK_SOURCE_USE_DEFAULT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span>
<span class="w">    </span><span class="n">SPI_CLK_SOURCE_FAST_CLKGEN0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">SPI_CLK_SOURCE_SLOW_CLKGEN7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x800</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="n">spi_clock_sources_t</span><span class="p">;</span>
</code></pre></div>
The SPI peripheral requires both a fast and a slow clock. The fast clock is used for operational purposes, while the slow one is for synchronization.</p>
<p>To select both clocks, use an OR operation on the flags, such as:
<div class="highlight"><pre><span></span><code><span class="cp">#define SPI_PERIPHERAL_CLK_SOURCES (SPI_CLK_SOURCE_FAST_CLKGEN0 | SPI_CLK_SOURCE_SLOW_CLKGEN3)</span>

<span class="n">SPI_HOST_INIT</span><span class="p">(</span><span class="n">SPI_PERIPHERAL_0</span><span class="p">,</span><span class="w"> </span><span class="n">SPI_PERIPHERAL_CLK_SOURCES</span><span class="p">,</span><span class="w"> </span><span class="p">...</span>
</code></pre></div></p>
<p>For default clock settings, use <code>SPI_CLK_SOURCE_USE_DEFAULT</code>, especially with ASF or Arduino frameworks.</p>
</details>
<details class="info">
<summary>periph_clk_freq</summary>
<p>Specifies the output frequency of the selected fast frequency clock generator.</p>
<p>Typical values:</p>
<table>
<thead>
<tr>
<th>Clock generator</th>
<th>Platform</th>
<th>Framework</th>
<th>periph_clk_freq</th>
</tr>
</thead>
<tbody>
<tr>
<td>Clock generator 0</td>
<td>SAMD51</td>
<td>Arduino</td>
<td>120000000 (120 MHz)</td>
</tr>
<tr>
<td>Clock generator 0</td>
<td>SAMD51</td>
<td>ASF</td>
<td>8000000  (8 MHz)</td>
</tr>
<tr>
<td>Clock generator 0</td>
<td>SAMD21</td>
<td>Arduino</td>
<td>48000000 (48 MHz)</td>
</tr>
<tr>
<td>Clock generator 0</td>
<td>SAMD21</td>
<td>ASF</td>
<td>8000000 (8 MHz)</td>
</tr>
</tbody>
</table>
<p>With Arduino's default clock system, use <code>F_CPU</code> for this setting.</p>
</details>
<details class="info">
<summary>spi_bus_frequency</summary>
<p>Sets the SPI bus frequency.</p>
<p>The SAMD series supports SPI frequencies from 100 KHz to 24 MHz.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code>periph_clk_freq</code> must be at least twice the desired SPI bus frequency.</p>
</div>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="cp">#define PERIPH_CLOCK_FREQ 48000000 </span><span class="cm">/* Peripheral clock frequency of 48 MHz */</span>
<span class="cp">#define SPI_CLOCK_FREQ 1000000 </span><span class="cm">/* SPI bus frequency of 1 MHz */</span>

<span class="n">SPI_HOST_INIT</span><span class="p">(</span><span class="n">SPI_PERIPHERAL_0</span><span class="p">,</span><span class="w"> </span><span class="n">SPI_CLK_SOURCE_USE_DEFAULT</span><span class="p">,</span><span class="w"> </span><span class="n">PERIPH_CLOCK_FREQ</span><span class="p">,</span><span class="w"> </span><span class="n">SPI_CLOCK_FREQ</span><span class="p">,</span><span class="w"> </span><span class="p">...</span>
</code></pre></div></p>
</details>
<details class="info">
<summary>extra_configuration_options</summary>
<p>The <code>extra_configuration_options</code> parameter in the SPI initialization function allows you to specify additional, platform-specific settings for the SPI bus. These options can be used to fine-tune the SPI peripheral's behavior to suit your application's needs. Here's a breakdown of the available options:</p>
<ul>
<li><strong>SPI_BUS_OPT_USE_DEFAULT</strong>:<ul>
<li>Utilizes the default SPI settings. This option is suitable when the default configuration of the SPI bus aligns with your application's requirements.</li>
</ul>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Default SPI settings</p>
<ul>
<li>DOPO settings: 1 -&gt; MOSI: SERCOM_PAD[2] SCK: SERCOM_PAD[3] SS: SERCOM_PAD[1]</li>
<li>DIPO settings: 0 -&gt; MISO: SERCOM_PAD[0]</li>
<li>MSB first</li>
<li>8-bit character size</li>
<li>Clock polarity low in idle state</li>
</ul>
</div>
<ul>
<li>
<p><strong>SPI_BUS_OPT_CLOCK_POLARITY_SCK_HIGH (0x01)</strong>:</p>
<ul>
<li>Sets the idle state of the clock line (SCK) to high. The clock polarity option is crucial for ensuring proper synchronization between the SPI master and slave devices.</li>
</ul>
</li>
<li>
<p><strong>SPI_BUS_OPT_DATA_ORDER_LSB_FIRST (0x02)</strong>:</p>
<ul>
<li>Configures the SPI bus to transmit data starting with the least significant bit first. By default, the SPI protocol transmits the most significant bit first.</li>
</ul>
</li>
<li>
<p><strong>SPI_BUS_OPT_CHAR_SIZE_10_BIT (0x04)</strong>:</p>
<ul>
<li>Adjusts the character size for SPI communication to 10 bits. This setting is useful for applications that require data transfers larger than the standard 8-bit size.</li>
</ul>
</li>
<li>
<p><strong>SPI_BUS_OPT_DOPO_PAD_0 (0x08)</strong> to <strong>SPI_BUS_OPT_DOPO_PAD_3 (0x20)</strong>:</p>
<ul>
<li>These options define the Data Out Pinout (DOPO) mapping for the SPI bus. They determine which physical pin (pad) on the microcontroller is used for the MOSI (Master Out Slave In) signal.</li>
</ul>
</li>
<li>
<p><strong>SPI_BUS_OPT_DIPO_PAD_0 (0x40)</strong> to <strong>SPI_BUS_OPT_DIPO_PAD_3 (0x100)</strong>:</p>
<ul>
<li>Similar to DOPO, these options set the Data In Pinout (DIPO) for the SPI bus. They specify the physical pin (pad) used for the MISO (Master In Slave Out) signal.</li>
</ul>
</li>
</ul>
<p><strong>The configuration of DOPO and DIPO is crucial for correctly routing SPI signals to the appropriate pins on the microcontroller, especially in designs where multiple peripherals share the same physical pins.</strong></p>
<p>Combining these options allows for comprehensive customization of the SPI bus. For instance, to set a high clock polarity, LSB-first data order, and specific pad settings for MOSI and MISO, you would bitwise OR the respective options:</p>
<div class="highlight"><pre><span></span><code><span class="n">spi_bus_opt_t</span><span class="w"> </span><span class="n">my_spi_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SPI_BUS_OPT_CLOCK_POLARITY_SCK_HIGH</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SPI_BUS_OPT_DATA_ORDER_LSB_FIRST</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SPI_BUS_OPT_DOPO_PAD_0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SPI_BUS_OPT_DIPO_PAD_1</span><span class="p">;</span>
</code></pre></div>
<p>This parameter ensures that the SPI configuration can be tailored to a wide variety of use cases.</p>
</details>
<h2 id="example-configuration">Example configuration</h2>
<div class="admonition example">
<p class="admonition-title">Adafruit Feather M0 (SAMD21)</p>
<p>Configuration for a SAMD21G18A (Adafruit Feather M0) using the Arduino framework with default clock settings (48 MHz).</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;hal_gpio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;hal_spi_host.h&gt;</span>

<span class="cp">#ifndef F_CPU</span>
<span class="cp">#define F_CPU 48000000 </span><span class="cm">/* Peripheral clock speed of 48 MHz */</span>
<span class="cp">#endif</span>

<span class="cm">/* Set PA22 as MISO, PA24 as MOSI, PA25 as SCK, and PA23 as SS */</span>
<span class="cp">#define MISO_PIN GPIO_PIN_PA22</span>
<span class="cp">#define MOSI_PIN GPIO_PIN_PA24</span>
<span class="cp">#define SCK_PIN GPIO_PIN_PA25</span>
<span class="cp">#define SS_PIN GPIO_PIN_PA23</span>

<span class="cp">#define SPI_CLOCK_SPEED 1000000 </span><span class="cm">/* SPI bus speed of 1 MHz */</span>

<span class="cm">/* Use SERCOM3 as peripheral */</span>
<span class="cp">#define SPI_PERIPHERAL SPI_PERIPHERAL_3</span>

<span class="cm">/* Use default clock sources, e.g., Arduino framework clock system */</span>
<span class="cp">#define SPI_CLOCK_SOURCE SPI_CLK_SOURCE_USE_DEFAULT</span>

<span class="cm">/* Use the default configuration options */</span>
<span class="cp">#define SPI_EXTRA_CONFIG_OPTIONS SPI_BUS_OPT_USE_DEFAULT</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">GPIO_SET_PIN_MODE</span><span class="p">(</span><span class="n">MISO_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_MODE_C</span><span class="p">)</span>
<span class="w">   </span><span class="n">GPIO_SET_PIN_MODE</span><span class="p">(</span><span class="n">MOSI_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_MODE_C</span><span class="p">);</span>
<span class="w">   </span><span class="n">GPIO_SET_PIN_MODE</span><span class="p">(</span><span class="n">SCK_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_MODE_C</span><span class="p">);</span>
<span class="w">   </span><span class="n">GPIO_SET_PIN_MODE</span><span class="p">(</span><span class="n">SS_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_MODE_C</span><span class="p">);</span>
<span class="w">   </span><span class="n">SPI_HOST_INIT</span><span class="p">(</span><span class="n">SPI_PERIPHERAL</span><span class="p">,</span><span class="w"> </span><span class="n">SPI_CLOCK_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">F_CPU</span><span class="p">,</span><span class="w"> </span><span class="n">SPI_CLOCK_SPEED</span><span class="p">,</span><span class="w"> </span><span class="n">SPI_EXTRA_CONFIG_OPTIONS</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre></div>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": [], "search": "../../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
        <script src="../../../../../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>